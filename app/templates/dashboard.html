<!-- START - Documentation and research materials were used in the development of the code, 
including but not limited to academic papers, articles, blog posts, and YouTube video tutorials. Please see referenced links.  -->

{% extends "base.html" %} {% block title %}Project Dashboard{% endblock %} {% block content %}
<!-- flash message -->
{% with messages = get_flashed_messages(with_categories=true) %} {% if messages %} {% for category, message in messages %}
<div class="alert alert-{{ category }} flash-message">{{ message }}</div>
{% endfor %} {% endif %} {% endwith %}

<main class="container mt-2">
    <div class="row">
        <div class="col-12">
            <div id="universal-message-container" style="display: none;">
                <!-- messages placeholder -->
            </div>
        </div>

        <div class="col-12 d-flex justify-content-between mb-2">
            <button id="live-streaming-btn" class="btn btn-outline-primary">
                <i class="fa-solid fa-circle-stop icon-margin"></i> Not Streaming
            </button>

            <a href="{{ url_for('main.questions_and_answers') }}" class="no-underline">
                <button id="need-help" class="btn btn btn-outline-primary custom-color-help-btn">
                    <i class="fa-solid fa-circle-question"></i> Need help?
                </button>
            </a>
        </div>
    </div>
    <div class="row">
        <!-- video section -->
        <div class="col-md-9">
            <div class="card">
                <div class="card-body">
                    <div id="video-mic-permission-message" class="alert alert-warning" style="display: none;">
                        <!-- permission message placeholder -->
                    </div>

                    <!-- video container -->
                    <div class="video-container">
                        <div id="video-display-feed" style="display: none;">
                            <!-- video placeholder -->
                            <img id="video" src="{{ url_for('blueprint_streaming_services.video_streamer') }}" class="img-fluid">
                        </div>
                        <div id="video-placeholder" class="video-placeholder"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- side bar on the right -->
        <div class="col-md-3" id="side-bar-card">
            <div class="card">
                <div class="card-body">
                    <div class="d-flex flex-column mb-2">
                        <!-- camera buttons section -->
                        <div class="row mt-2 mb-2">
                            <div class="col">
                                <button id="cameraon" class="btn custom-color-camera-on-btn w-100 mb-3">
                                    <i class="fa-solid fa-video fa-lg me-2"></i> Camera On
                                </button>
                            </div>
                            <div class="col">
                                <button id="cameraoff" class="btn custom-color-camera-off-btn w-100">
                                    <i class="fa-solid fa-video-slash fa-lg me-2"></i> Camera Off
                                </button>
                            </div>
                        </div>

                        <!-- motion, storage and notifications section -->
                        <div class="mb-2">
                            <!-- motion detection dropdown -->
                            <label for="motion-detection-select" class="form-label">Motion detection
                                <i class="fa-solid fa-question-circle tooltip-color";" data-bs-toggle="tooltip" data-bs-placement="top" title="Please experiment with different modes to find the one that best suits your home."></i>
                            </label>
                            <select id="motion-detection-select" class="form-select mb-2">
                                <option value="mgo2" {% if user_detection_mode == 'mgo2' %} selected {% endif %}>MGO2 Detection</option>
                                <option value="lucas_kanade_orb" {% if user_detection_mode == 'lucas_kanade_orb' %} selected {% endif %}>LK-ORB Detection</option>
                                <option value="mckenna" {% if user_detection_mode == 'mckenna' %} selected {% endif %}>McKenna Detection</option>
                            </select>
                            <div id="detection-mode-message" style="display: none;"></div>
                        </div>

                        <!-- google drive section -->
                        <div class="mb-3">
                            <label for="connectToGoogleDrive" class="form-label">Google Drive
                                <i class="fa-solid fa-question-circle tooltip-color";" data-bs-toggle="tooltip" data-bs-placement="top" title="If you do not connect Google Drive, videos will be saved to app/static/videos directory."></i>
                            </label>
                            <button type="button" class="btn btn-secondary" id="connectToGoogleDrive" data-connect-url="{{ url_for('blueprint_google_oauth2callback.connect_google_drive') }}"></button>
                        </div>

                        <!-- email notifications dropdown -->
                        <div class="mb-2">
                            <label for="email-notifications-select" class="form-label" data-bs-toggle="tooltip" data-bs-placement="top" title="Select [all] to receive all motion detection emails. Choose [hourly] to receive summaries.">
                                Notifications <i class="fa-solid fa-question-circle tooltip-color"></i>
                            </label>
                            <select id="email-notifications-select" class="form-select">
                                <option value="defaultvalue" disabled selected>Select type</option>
                                <option value="all">All</option>
                                <option value="hourly">Hourly</option>
                                <option value="none">None</option>
                            </select>
                            <div id="email-notification-message" style="display: none;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- video history main section -->
    <div class="card mt-3">
        <div class="card-body">
            <div class="row mb-4">
                <div class="col-12 d-flex justify-content-between align-items-center mb-3">
                    <!-- date dropdown -->
                    <div class="d-flex align-items-center">
                        <label for="date-selector" class="label-right-margin">Select date</label>
                        <select id="date-selector" class="form-control w-auto" onchange="loadVideosForDateAndLocal()">
                            <!-- placeholder for js loaded content -->
                        </select>
                    </div>
                </div>
            </div>

            <!-- video cards section -->
            <div class="row">
                <div class="col-12">
                    <div class="d-flex flex-row video-scrolling-container" id="video-content">
                        <!-- placeholder for js loaded content -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- includes modals -->
{% include 'modals.html' %}


<script type="text/javascript" src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/video_display_drive.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/google_drive_storage.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/notifications_mode_preferences.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/video_display_local.js') }}"></script>

{% endblock %}

<!-- References:
https://origin.fontawesome.com/v6/docs/
https://developer.mozilla.org/en-US/docs/Web/HTML
https://developer.mozilla.org/en-US/docs/Web/CSS
https://developer.mozilla.org/en-US/docs/Web/JavaScript
https://getbootstrap.com/docs/5.3/getting-started/introduction/
https://popper.js.org/docs/v2/
https://api.jquery.com
https://svn.python.org/projects/external/Jinja-2.1.1/docs/_build/html/index.html
https://api.jquery.com/category/ajax/ 
https://flask.palletsprojects.com/en/3.0.x/patterns/wtforms/
https://flask.palletsprojects.com/en/1.1.x/patterns/flashing/
https://flask.palletsprojects.com/en/3.0.x/
https://getbootstrap.com/docs/4.0/components/tooltips/
https://getbootstrap.com/docs/4.4/components/toasts/
https://getbootstrap.com/docs/5.2/components/modal/
https://flask-wtf.readthedocs.io/en/0.15.x/quickstart/
https://getbootstrap.com/docs/5.0/components/accordion/
https://getbootstrap.com/docs/5.0/forms/form-control/
https://getbootstrap.com/docs/4.0/components/forms/
https://fontawesome.com/icons
-->

<!-- END - Documentation and research materials were used in the development of the code, 
including but not limited to academic papers, articles, blog posts, and YouTube video tutorials. Please see referenced links.  -->